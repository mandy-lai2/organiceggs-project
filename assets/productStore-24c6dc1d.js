import{E as u,G as r}from"./index-56eba1de.js";import{l as g}from"./loadingStore-b73227ed.js";import{S as l}from"./sweetalert2.all-c9effd99.js";const{VITE_API:i,VITE_APIPATH:c}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"mandyapi",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},s=g(),P=u("productStore",{state:()=>({products:[],tempProduct:{},categoryProducts:[],likeProducts:[],likeProductsNum:0}),actions:{getProducts(){s.isLoading=!0,r.get(`${i}/api/${c}/products/all`).then(t=>{this.products=t.data.products,s.isLoading=!1}).catch(t=>{alert(t.response.data.message)})},getProduct(t){s.isLoading=!0,r.get(`${i}/api/${c}/product/${t}`).then(e=>{this.tempProduct=e.data.product,this.getCategoryProducts(),s.isLoading=!1}).catch(e=>{alert(e.response.data.message)})},getCategoryProducts(){const{category:t}=this.tempProduct;r.get(`${i}/api/${c}/products?category=${t}`).then(e=>{this.categoryProducts=e.data.products}).catch(e=>{alert(e.response.data.message)})},addLikeProduct(t=" "){let e=localStorage.getItem("likeItem"),o=e?JSON.parse(e):[];o.some(a=>a===t)||o.push(t),localStorage.setItem("likeItem",JSON.stringify(o)),this.getLikeProduct(),setTimeout(()=>{l.fire({position:"center",icon:"success",title:"成功加入最愛",showConfirmButton:!1,timer:1500})},500)},delLikeProduct(t=""){let e=localStorage.getItem("likeItem"),o=e?JSON.parse(e):[];o.forEach((a,d)=>{a===t&&(o.splice(d,1),console.log("getdata->",o))}),localStorage.setItem("likeItem",JSON.stringify(o)),this.getLikeProduct(),setTimeout(()=>{l.fire({position:"center",icon:"success",title:"已刪除",showConfirmButton:!1,timer:1500})},500)},getLikeProduct(){s.isLoading=!0;let t=localStorage.getItem("likeItem"),e=t?JSON.parse(t):[];this.likeProducts=[],Promise.all(e.map(o=>r.get(`${i}/api/${c}/product/${o}`))).then(o=>{this.likeProducts=o.map(a=>a.data.product),this.likeProductsNum=this.likeProducts.length,s.isLoading=!1,console.log("likeProducts->",this.likeProducts)})}},getters:{}});export{P as p};
